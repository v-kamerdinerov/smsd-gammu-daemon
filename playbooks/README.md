Данная роль предназначена для автоматизации настройки и установки `gammu-smsd` на сервере, а также для интеграции с Telegram для отправки SMS-уведомлений. Плейбук выполняет следующие задачи:

1. **Сбор информации о USB-устройствах**: Определяет наличие USB-устройства Huawei.
2. **Проверка наличия устройства Huawei**: Если устройство не найдено, плейбук завершается с ошибкой.
3. **Разделение идентификатора USB-устройства**: Извлекает vendor code и device ID из идентификатора USB-устройства.
4. **Установка необходимых пакетов**: Обновляет кэш пакетов и устанавливает `gammu-smsd` и другие необходимые пакеты.
5. **Создание директорий**: Создает необходимые директории для работы `gammu-smsd`.
6. **Настройка системы**:
   - Создает udev-правила для автоматического распознавания USB-модемов.
   - Настраивает конфигурационный файл `gammu-smsdrc`.
   - Создает и настраивает Python-скрипт для отправки SMS в Telegram.
   - Добавляет и настраивает скрипт-наблюдатель (watcher) и создает systemd-юниты для его запуска.
7. **Запуск и включение сервисов**: Запускает и включает сервисы `gammu-smsd`, `watcher.service` и `watcher.timer`.

## Инструкция по настройке

Для корректной работы необходимо заполнить три переменные в файле `group_vars/gammu.yml`:

1. **gammu_telegram_chat_id**: Укажите ID чата в Telegram, куда будут отправляться SMS-уведомления.
2. **gammu_telegram_token**: Укажите токен бота Telegram, который будет использоваться для отправки сообщений.
3. **gammu_number**: Укажите номер телефона, который будет использоваться для отправки SMS.

Пример заполнения переменных в `group_vars/gammu.yml`:

```yaml
gammu_telegram_chat_id: "123456789"
gammu_telegram_token: "your_telegram_bot_token"
gammu_number: "+1234567890"
```

После заполнения переменных запустите плейбук, и система будет автоматически настроена для работы с `gammu-smsd` и интеграции с Telegram.

## Запуск плейбука

Для запуска плейбука используйте команду:

```bash
ansible-playbook gammu.yml
```

## Теги

Для более гибкого выполнения плейбука доступны следующие теги:

- **install**: Установка необходимых пакетов.
- **config**: Настройка конфигурационных файлов и создание необходимых директорий.
- **service**: Запуск и включение сервисов.
- **debug**: Отладка и вывод информации о подключенных USB-устройствах.